<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.6.1"/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1.0"/><meta data-react-helmet="true" http-equiv="Content-Type" content="text/html;charset=UTF-8"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:title" content="무한 스크롤 구현하기"/><meta data-react-helmet="true" property="og:url"/><meta data-react-helmet="true" property="og:site_name" content="무한 스크롤 구현하기"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="무한 스크롤 구현하기"/><meta data-react-helmet="true" name="twitter:site" content="@사용자이름"/><meta data-react-helmet="true" name="twitter:creator" content="@사용자이름"/><style data-href="/styles.9e907bc32054b7771552.css" data-identity="gatsby-global-css">code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#ccc;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}</style><link rel="canonical" href="https://devseop.github.io/infinite-scroll/" data-baseprotocol="https:" data-basehost="devseop.github.io"/><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/><title data-react-helmet="true">무한 스크롤 구현하기</title><link data-react-helmet="true" rel="shortcut icon" href="favicon.ico"/><link data-react-helmet="true" rel="icon" href="favicon.ico"/><link data-react-helmet="true" rel="icon" type="image/png" href="favicon.ico" sizes="16x16"/><style type="text/css">
    .custom-class.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .custom-class.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .custom-class svg,
    h2 .custom-class svg,
    h3 .custom-class svg,
    h4 .custom-class svg,
    h5 .custom-class svg,
    h6 .custom-class svg {
      visibility: hidden;
    }
    h1:hover .custom-class svg,
    h2:hover .custom-class svg,
    h3:hover .custom-class svg,
    h4:hover .custom-class svg,
    h5:hover .custom-class svg,
    h6:hover .custom-class svg,
    h1 .custom-class:focus svg,
    h2 .custom-class:focus svg,
    h3 .custom-class:focus svg,
    h4 .custom-class:focus svg,
    h5 .custom-class:focus svg,
    h6 .custom-class:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 100)
          }), 0)
        }
      }
    })
  </script><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css-global 12mkisr">@import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.6/dist/web/static/pretendard-dynamic-subset.css');*{padding:0;margin:0;box-sizing:border-box;font-family:'Pretendard',san-serif;}body{background:#fff;}a,a:hover{-webkit-text-decoration:none;text-decoration:none;cursor:pointer;}</style><style data-emotion="css 15b5qda">.css-15b5qda{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;padding:12px 40px;background-color:rgba(255, 255, 255, 0.6);box-shadow:0px 1px 0px 0px rgba(34, 34, 34, 0.2);-webkit-backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);position:-webkit-sticky;position:sticky;top:0;z-index:1;}</style><nav class="css-15b5qda ehcuuqj5"><style data-emotion="css 19f4qz1">.css-19f4qz1{line-height:1;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;}.css-19f4qz1 h1{font-size:24px;font-weight:500;}.css-19f4qz1 a{-webkit-text-decoration:none;text-decoration:none;}.css-19f4qz1 a:visited{color:#222;}</style><div class="css-19f4qz1 ehcuuqj4"><a href="/"><h1>이윤섭</h1></a></div><style data-emotion="css udmynv">.css-udmynv{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:16px;}</style><div class="css-udmynv ehcuuqj3"><style data-emotion="css 1c46kml">.css-1c46kml{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:4px;padding:0 16px;margin-top:5px;color:#222;-webkit-text-decoration:none;text-decoration:none;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;cursor:pointer;}.css-1c46kml:hover{color:#3680ff;}</style><a href="https://drive.google.com/file/d/1xOZNJKoUjCpREhfGxfwwZv3Vgr1O_OhV/view?usp=sharing" target="_blank" class="css-1c46kml ehcuuqj2"><style data-emotion="css 14is9qy">.css-14is9qy{font-size:20px;}</style><div class="css-14is9qy ehcuuqj1"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M7.38938 16.5386C5.33894 15.0901 4 12.7014 4 10C4 5.58172 7.58172 2 12 2C16.4183 2 20 5.58172 20 10C20 12.7014 18.6611 15.0901 16.6106 16.5386L18.6936 21.2996C18.8043 21.5526 18.6889 21.8474 18.4359 21.9581C18.3727 21.9857 18.3045 22 18.2355 22H5.76451C5.48837 22 5.26451 21.7761 5.26451 21.5C5.26451 21.431 5.27878 21.3628 5.30643 21.2996L7.38938 16.5386ZM8.11851 10.9704C8.55217 12.7106 10.1255 14 12 14C13.8745 14 15.4478 12.7106 15.8815 10.9704L13.9407 10.4852C13.7239 11.3553 12.9372 12 12 12C11.0628 12 10.2761 11.3553 10.0593 10.4852L8.11851 10.9704Z"></path></svg></div><style data-emotion="css mqo9y5">.css-mqo9y5{line-height:1;margin-top:3px;}</style><span class="css-mqo9y5 ehcuuqj0">이력서</span></a><a href="https://github.com/devseop/" target="_blank" class="css-1c46kml ehcuuqj2"><div class="css-14is9qy ehcuuqj1"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M12.001 2C6.47598 2 2.00098 6.475 2.00098 12C2.00098 16.425 4.86348 20.1625 8.83848 21.4875C9.33848 21.575 9.52598 21.275 9.52598 21.0125C9.52598 20.775 9.51348 19.9875 9.51348 19.15C7.00098 19.6125 6.35098 18.5375 6.15098 17.975C6.03848 17.6875 5.55098 16.8 5.12598 16.5625C4.77598 16.375 4.27598 15.9125 5.11348 15.9C5.90098 15.8875 6.46348 16.625 6.65098 16.925C7.55098 18.4375 8.98848 18.0125 9.56348 17.75C9.65098 17.1 9.91348 16.6625 10.201 16.4125C7.97598 16.1625 5.65098 15.3 5.65098 11.475C5.65098 10.3875 6.03848 9.4875 6.67598 8.7875C6.57598 8.5375 6.22598 7.5125 6.77598 6.1375C6.77598 6.1375 7.61348 5.875 9.52598 7.1625C10.326 6.9375 11.176 6.825 12.026 6.825C12.876 6.825 13.726 6.9375 14.526 7.1625C16.4385 5.8625 17.276 6.1375 17.276 6.1375C17.826 7.5125 17.476 8.5375 17.376 8.7875C18.0135 9.4875 18.401 10.375 18.401 11.475C18.401 15.3125 16.0635 16.1625 13.8385 16.4125C14.201 16.725 14.5135 17.325 14.5135 18.2625C14.5135 19.6 14.501 20.675 14.501 21.0125C14.501 21.275 14.6885 21.5875 15.1885 21.4875C19.259 20.1133 21.9999 16.2963 22.001 12C22.001 6.475 17.526 2 12.001 2Z"></path></svg></div><span class="css-mqo9y5 ehcuuqj0">깃허브</span></a></div></nav><style data-emotion="css 1980g9g">.css-1980g9g{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin:40px auto;max-width:1440px;}</style><section class="css-1980g9g ekkml1s1"><style data-emotion="css 1vs9i7r">.css-1vs9i7r{width:360px;}</style><aside class="css-1vs9i7r e199j04p5"><style data-emotion="css 1o7upgt">.css-1o7upgt{padding:16px 40px 0 0;opacity:0.3;-webkit-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out;overflow-y:auto;position:-webkit-sticky;position:sticky;top:94px;max-height:calc(100vh - 54px - 40px);}.css-1o7upgt:hover{opacity:1;}</style><nav class="css-1o7upgt e199j04p4"><style data-emotion="css oyx6p9">.css-oyx6p9{margin:0 0 16px 12px;color:#222;font-size:24px;font-weight:500;line-height:1;letter-spacing:-0.72px;}</style><h1 class="css-oyx6p9 e199j04p3">작성글</h1><style data-emotion="css 9xgbk0">.css-9xgbk0{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:8px;list-style-type:none;}</style><ul class="css-9xgbk0 e199j04p2"><style data-emotion="css 1v2vkhl">.css-1v2vkhl{color:#222;-webkit-text-decoration:none;text-decoration:none;line-height:1.4;width:320px;}.css-1v2vkhl:visited{color:#222;-webkit-text-decoration:none;text-decoration:none;}</style><a class="css-1v2vkhl e199j04p0" href="/lorem-ipsum-generator/"><style data-emotion="css jnqmmb">.css-jnqmmb{padding:12px;border-radius:6px;-webkit-filter:grayscale(100%);filter:grayscale(100%);-webkit-transition:filter 0.2s ease-in-out;transition:filter 0.2s ease-in-out;cursor:pointer;}.css-jnqmmb:hover{-webkit-filter:none;filter:none;background-color:rgba(0, 0, 0, 0.07);}</style><li class="css-jnqmmb e199j04p1">한국의 시를 이용한 로렘 입숨 생성기</li></a><a class="css-1v2vkhl e199j04p0" href="/wanted-preonboarding-review/"><li class="css-jnqmmb e199j04p1">원티드 프리온보딩 인턴십(프론트엔드) 후기</li></a><a aria-current="page" class="css-1v2vkhl e199j04p0" href="/infinite-scroll/"><li class="css-jnqmmb e199j04p1">무한 스크롤 구현하기</li></a><a class="css-1v2vkhl e199j04p0" href="/useref/"><li class="css-jnqmmb e199j04p1">useRef 알아보기</li></a><a class="css-1v2vkhl e199j04p0" href="/js-debouncing-n-throttling/"><li class="css-jnqmmb e199j04p1">자바스크립에서 이벤트 제어하기</li></a><a class="css-1v2vkhl e199j04p0" href="/blog-publish-review/"><li class="css-jnqmmb e199j04p1">Gatsby로 블로그 만들기</li></a><a class="css-1v2vkhl e199j04p0" href="/teo-sprint-11th/"><li class="css-jnqmmb e199j04p1">테오의 스프린트 11기 후기</li></a><a class="css-1v2vkhl e199j04p0" href="/nth-type-difference/"><li class="css-jnqmmb e199j04p1">nth-child와 nth-of-type의 차이</li></a><a class="css-1v2vkhl e199j04p0" href="/pleasy-intern-review/"><li class="css-jnqmmb e199j04p1">플리지 인턴 후기</li></a><a class="css-1v2vkhl e199j04p0" href="/2nd-project-review/"><li class="css-jnqmmb e199j04p1">위코드 2차 프로젝트 후기</li></a><a class="css-1v2vkhl e199j04p0" href="/1st-project-review/"><li class="css-jnqmmb e199j04p1">위코드 1차 프로젝트 후기</li></a></ul></nav></aside><style data-emotion="css 15x83x4">.css-15x83x4{max-width:644px;}</style><main class="css-15x83x4 ekkml1s0"><style data-emotion="css gz1wck">.css-gz1wck{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-width:644px;max-width:644px;margin:0 auto;}</style><header class="css-gz1wck exws4ym3"><style data-emotion="css 19obpe4">.css-19obpe4{display:-webkit-box;overflow:hidden;overflow-wrap:break-word;text-overflow:ellipsis;white-space:normal;-webkit-line-clamp:2;-webkit-box-orient:vertical;font-size:36px;font-weight:700;line-height:1.2;margin-bottom:12px;color:#222;}</style><h2 class="css-19obpe4 exws4ym2">무한 스크롤 구현하기</h2><style data-emotion="css d2fic6">.css-d2fic6{font-size:14px;color:#222;}</style><p class="css-d2fic6 exws4ym1">2023.09.02.</p></header><style data-emotion="css n1sqxm">.css-n1sqxm{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:644px;margin:0 auto;padding:64px 0;word-break:break-all;color:#222;line-height:1.5;font-size:17px;font-weight:300;}.css-n1sqxm p{padding:0;}.css-n1sqxm h1,.css-n1sqxm h2,.css-n1sqxm h3{font-weight:700;margin-bottom:16px;}.css-n1sqxm *+h1,.css-n1sqxm *+h2,.css-n1sqxm *+h3{margin-top:40px;}.css-n1sqxm hr+h1,.css-n1sqxm hr+h2,.css-n1sqxm hr+h3{margin-top:0;}.css-n1sqxm h1{font-size:32px;}.css-n1sqxm h2{font-size:24px;}.css-n1sqxm h3{font-size:20px;}.css-n1sqxm blockquote{margin:32px 0;padding:20px 32px 20px;border-left:4px solid #4263eb;font-weight:400;background:rgba(34, 34, 34, 0.05);line-height:1.5;}.css-n1sqxm ol,.css-n1sqxm ul{margin-left:20px;}.css-n1sqxm hr{border:0.5px solid rgba(34, 34, 34, 0.5);margin:64px 0;}.css-n1sqxm a{color:#4263eb;-webkit-text-decoration:underline;text-decoration:underline;}.css-n1sqxm table{margin:24px 0;background-color:rgba(34, 34, 34, 0.05);border:0.5px solid rgba(34, 34, 34, 0.3);font-size:14px;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;min-width:40%;max-width:100%;border-collapse:collapse;box-sizing:inherit;}.css-n1sqxm th{padding:8px;border-bottom:3px solid rgba(34, 34, 34, 0.3);}.css-n1sqxm td{padding:8px;}.css-n1sqxm table td+td,.css-n1sqxm table th+th{border-left:0.5px solid rgba(34, 34, 34, 0.3);}.css-n1sqxm pre[class*='language-']{margin:16px 0;padding:16px 20px;font-size:14px;border-radius:10px;}.css-n1sqxm pre[class*='language-']::-webkit-scrollbar-thumb{background:rgba(255, 255, 255, 0.5);border-radius:3px;}.css-n1sqxm code[class*='language-'],.css-n1sqxm pre[class*='language-']{tab-size:2;}.css-n1sqxm pre>code{font-family:'JetBrains Mono';}.css-n1sqxm pre>code .token.function{color:#b392f0;}.css-n1sqxm pre>code .token.keyword,.css-n1sqxm pre>code .token.operator{color:#f97583;}.css-n1sqxm pre>code .token.string,.css-n1sqxm pre>code .token.constant,.css-n1sqxm pre>code .token.boolean,.css-n1sqxm pre>code .token.number{color:#9ecbff;}.css-n1sqxm pre>code .token.parameter{color:#ffab70;}.css-n1sqxm pre>code .token.literal-property.property{color:#fff;}</style><article class="css-n1sqxm exws4ym0"><p>프론트엔드 기술 과제에서는 리스트 페이지에서 무한 스크롤을 구현하라는 요구 사항을 본 적이 있다. 나 또한 기술 과제와 <a href="/wanted-preonboarding-review">원티드 프리온보딩 인턴십</a>을 진행하면서 종종 마주쳤다. 무한 스크롤은 방대한 양의 콘텐츠를 스크롤할 수 있는 기술로 페이지를 아래로 스크롤할 때 새로고침이 되면서 콘텐츠를 추가적으로 불러오는 방법이다. 프론트엔드 개발자라면 피할 수 없는 무한 스크롤에 대해 복습하고 정리하는 차원에서 작성해보기로 했다.</p>
<h2 id="무한-스크롤-먼저보기" style="position:relative;"><a href="#%EB%AC%B4%ED%95%9C-%EC%8A%A4%ED%81%AC%EB%A1%A4-%EB%A8%BC%EC%A0%80%EB%B3%B4%EA%B8%B0" aria-label="무한 스크롤 먼저보기 permalink" class="custom-class before"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>무한 스크롤 먼저보기</h2>
<ul>
<li><a href="https://github.com/devseop/po-fe-12th-w2" target="_blank" rel="nofollow">https://github.com/devseop/po-fe-12th-w2</a></li>
</ul>
<h2 id="사용한-기술" style="position:relative;"><a href="#%EC%82%AC%EC%9A%A9%ED%95%9C-%EA%B8%B0%EC%88%A0" aria-label="사용한 기술 permalink" class="custom-class before"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>사용한 기술</h2>
<p>무한 스크롤을 3가지 방법으로 구현한 경험이 있는데 그 때마다 사용된 기술은 아래와 같다.</p>
<ul>
<li>useEffect</li>
<li>Intersection Observer API</li>
<li>useInfiniteQuery (React-Query)</li>
</ul>
<h2 id="1-useEffect" style="position:relative;"><a href="#1-useEffect" aria-label="1 useEffect permalink" class="custom-class before"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. useEffect</h2>
<p><code class="language-text">useEffect</code>를 이용한 방법에서는 현재 스크롤된 위치와 브라우저의 세로 크기, 그리고 콘텐츠의 총 높이를 이용해 구현했다. 여기서 필요한 요소들은 아래와 같다.</p>
<ul>
<li><code class="language-text">window.scrollY</code>: 현재 스크롤의 위치</li>
<li><code class="language-text">document.documentElement.clientHeight</code>: 브라우저의 보이는 화면 높이</li>
<li><code class="language-text">document.documentElement.scrollHeight</code>: 콘텐츠의 총 높이</li>
</ul>
<br />
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">onScroll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>
      window<span class="token punctuation">.</span>scrollY <span class="token operator">+</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientHeight <span class="token operator">></span>
      document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollHeight <span class="token operator">-</span> <span class="token number">300</span>
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//TODO: 추가적인 데이터를 불러오는 로직</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span> onScroll<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span> onScroll<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<br />
<p>useEffect를 선언하고 스크롤 이벤트시 수행될 <code class="language-text">onScroll</code> 함수를 작성한다. <code class="language-text">window.scrollY + document.documentElement.clientHeight</code>는 사용자가 보고 있는 페이지의 맨 아래 위치를, <code class="language-text">document.documentElement.scrollHeight - 300</code>은 전체 콘텐츠의 높이에서 300px을 제외한 값을 나타낸다. 위 조건은 <strong>사용자가 페이지의 바닥에 거의 도달했는지를 확인</strong>하는 조건이다. 스크롤 이벤트가 발생하면서 조건이 참이 된다면 그 때 데이터를 불러오도록 하는 방식이다. 그리고 <code class="language-text">() => {window.removeEventListener('scroll', onScroll);};</code>를 반환하도록 하여 컴포넌트가 언마운드될 때 스크롤 이벤트 리스너를 제거하여 추가적인 호출이 진행되지 않도록 한다.</p>
<h2 id="2-Intersection-Observer-API" style="position:relative;"><a href="#2-Intersection-Observer-API" aria-label="2 Intersection Observer API permalink" class="custom-class before"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Intersection Observer API</h2>
<p>Intersection Observer API는 관찰 중인 요소(Element)가 사용자가 보고 있는 화면 영역(Viewport) 안에 들어왔는지를 알려주는 API이다. 해당 API는 무한 스크롤시 가장 많이 사용되는 방법이라고 생각하는데, useEffect는 조건을 설정하기 위한 코드가 번잡스럽고 useInfiniteQuery는 React-Query에 내장된 기능으로 해당 기술을 사용하지 않으면 의미가 없기 때문이다.</p>
<br />
<p>나는 Intersection Observer API를 이용하여 커스텀 훅을 만들고 이를 원하는 컴포넌트로 가져와서 사용하는 방식으로 구현했다.</p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> useInfinityScroll <span class="token operator">=</span> <span class="token punctuation">(</span>
  <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> React<span class="token punctuation">.</span>MutableRefObject<span class="token operator">&lt;</span>HTMLDivElement <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">></span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> containerRef <span class="token operator">=</span> <span class="token punctuation">(</span>useRef <span class="token operator">&lt;</span> HTMLDivElement<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">></span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
      root<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      rootMargin<span class="token operator">:</span> <span class="token string">'20px'</span><span class="token punctuation">,</span>
      threshold<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span>entries<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> target <span class="token operator">=</span> entries<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span>isIntersecting<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>containerRef<span class="token punctuation">.</span>current<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>containerRef<span class="token punctuation">.</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>containerRef<span class="token punctuation">.</span>current<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        observer<span class="token punctuation">.</span><span class="token function">unobserve</span><span class="token punctuation">(</span>containerRef<span class="token punctuation">.</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>containerRef<span class="token punctuation">,</span> callback<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> containerRef<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>해당 API를 사용할 때 옵션은 필수가 아니지만 설정해 놓으면 나중에 자세한 조정이 필요할 때 편리하다.</p>
<ul>
<li><code class="language-text">root</code>: 관찰 대상이 화면에 들어왔는지 여부를 감지한다. 기본값은 null이다.</li>
<li><code class="language-text">rootMargin</code>: 관찰 대상을 감지하는 영역을 바깥 범위(Margin)까지 확장한다. 기본값은 0px이며 해당 옵션값을 설정할 때는 문자열 형태로 해야한다.</li>
<li><code class="language-text">threshold</code>: 관찰 대상이 화면 영역에 얼마나 들어왔을 때 콜백 함수를 호출할지 결정한다. <code class="language-text">rootMargin</code>과 마찬가지로 기본값은 0(0%)이다. 최대 1(100%)까지 설정이 가능하다.</li>
</ul>
<br />
`IntersectionObserver`의 인스턴스인 `observer`를 선언한다. 이 때 `observer`는 `entries`라는 배열을 인자로 받는다. 그리고 인자의 첫번째 요소(target)이 교차하고 있는지 확인하고 조건이 참이라면 callback() 함수를 호출하여 더 많은 정보를 불러오도록 한다. 첫번째 방법과 마찬가지로 추가적인 호출이 진행되지 않도록 클린업 함수를 반환하도록 한다. 마지막으로 관찰할 대상 요소를 참조하기 위해 선언된 `containerRef`를 반환하도록 한다. 이렇게 작성된 `useInfinityScroll`를 컴포넌트에서 불러와 반환된 `containerRef`를 특정 요소에 연결하면, 해당 요소가 뷰포트에 들어올 때 추가적인 데이터를 불러올 수 있도록 한다.
<h2 id="3-useInfiniteQuery-React-Query" style="position:relative;"><a href="#3-useInfiniteQuery-React-Query" aria-label="3 useInfiniteQuery React Query permalink" class="custom-class before"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. useInfiniteQuery (React-Query)</h2>
<p><code class="language-text">useInfiniteQuery</code> 이용한 방법은 한 기업의 기술 과제를 진행하면서 구현했는데 이 때 서버 사이드의 상태와 클라이언트 사이드의 상태를 나누어 관리해보고 싶어서 <code class="language-text">React-Query(서버 사이드)</code>와 <code class="language-text">zustand(클라이언트 사이드)</code>로 나누어 리스트 페이지에서의 무한 스크롤을 구현했다.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">/* useInfiniteQuery 기본 구조 */</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>
  fetchNextPage<span class="token punctuation">,</span>
  fetchPreviousPage<span class="token punctuation">,</span>
  hasNextPage<span class="token punctuation">,</span>
  hasPreviousPage<span class="token punctuation">,</span>
  isFetchingNextPage<span class="token punctuation">,</span>
  isFetchingPreviousPage<span class="token punctuation">,</span>
  <span class="token operator">...</span>result
<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useInfiniteQuery</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  queryKey<span class="token punctuation">,</span>
  <span class="token function-variable function">queryFn</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> pageParam <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">fetchPage</span><span class="token punctuation">(</span>pageParam<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>options<span class="token punctuation">,</span>
  <span class="token function-variable function">getNextPageParam</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">lastPage<span class="token punctuation">,</span> allPages</span><span class="token punctuation">)</span> <span class="token operator">=></span> lastPage<span class="token punctuation">.</span>nextCursor<span class="token punctuation">,</span>
  <span class="token function-variable function">getPreviousPageParam</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">firstPage<span class="token punctuation">,</span> allPages</span><span class="token punctuation">)</span> <span class="token operator">=></span> firstPage<span class="token punctuation">.</span>prevCursor<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>useInfiniteQuery의 반환 값 중, <code class="language-text">fetchNextPage</code>, <code class="language-text">hasNextPage</code>, <code class="language-text">isFetchingNextPage</code>가 자주 쓰인다.</p>
<ul>
<li><code class="language-text">fetchNextPage</code>: 다음 페이지를 요청할 때 사용되는 메서드</li>
<li><code class="language-text">hasNextPage</code>: 다음 페이지가 있는지 판별하는 boolean 값</li>
<li><code class="language-text">isFetchingNextPage</code>: 다음 페이지를 불러오는 중인지 판별하는 boolean 값</li>
</ul>
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token comment">/* useGetArticles.ts */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useGetArticles</span> <span class="token operator">=</span> <span class="token punctuation">(</span>filters<span class="token operator">:</span> FilterValues<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token function-variable function">fetchArticles</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> pageParam <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> headline<span class="token punctuation">,</span> date<span class="token punctuation">,</span> countries <span class="token punctuation">}</span> <span class="token operator">=</span> filters<span class="token punctuation">;</span>

    <span class="token keyword">const</span> params<span class="token operator">:</span> ApiParamsProps <span class="token operator">=</span> <span class="token punctuation">{</span>
      page<span class="token operator">:</span> pageParam<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> rawData <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getData</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">getConvertedArticles</span><span class="token punctuation">(</span>rawData<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token function">useInfiniteQuery</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'articles'</span><span class="token punctuation">,</span> filters<span class="token punctuation">]</span><span class="token punctuation">,</span> fetchArticles<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">getNextPageParam</span><span class="token operator">:</span> <span class="token punctuation">(</span>_lastpage<span class="token punctuation">,</span> allpage<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> nextOffset <span class="token operator">=</span> allpage<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> nextOffset<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    retry<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token function-variable function">retryDelay</span><span class="token operator">:</span> <span class="token punctuation">(</span>retryAttempt<span class="token punctuation">)</span> <span class="token operator">=></span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>retryAttempt <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    staleTime<span class="token operator">:</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token comment">// 5분 후에 데이터가 오래된 것으로 간주</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">/* ArticleList.tsx */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">ArticleList</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> isVisible <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useToastStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> filters <span class="token operator">=</span> <span class="token function">useFilterStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=></span> state<span class="token punctuation">.</span>filters<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token punctuation">{</span>
    data<span class="token punctuation">,</span>
    isError<span class="token punctuation">,</span>
    isLoading<span class="token punctuation">,</span>
    fetchNextPage<span class="token punctuation">,</span>
    hasNextPage<span class="token punctuation">,</span>
    isFetchingNextPage<span class="token punctuation">,</span>
  <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useGetArticles</span><span class="token punctuation">(</span>filters<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> loadingRef <span class="token operator">=</span> <span class="token function">useInfinityScroll</span><span class="token punctuation">(</span>fetchNextPage<span class="token punctuation">,</span> hasNextPage <span class="token operator">??</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>isLoading<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Spinner</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>isError<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ErrorPage</span></span>
        <span class="token attr-name">pageText</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>데이터를 불러오는데 실패했습니다.<span class="token punctuation">"</span></span>
        <span class="token attr-name">buttonText</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>새로고침<span class="token punctuation">"</span></span>
      <span class="token punctuation">/></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 검색 결과가 없을 떄</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>pages<span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span> <span class="token operator">=></span> page<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ErrorPage</span></span>
        <span class="token attr-name">pageText</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>조건에 맞는 기사가 없습니다.<span class="token punctuation">"</span></span>
        <span class="token attr-name">buttonText</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>돌아가기<span class="token punctuation">"</span></span>
      <span class="token punctuation">/></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>isVisible <span class="token operator">&amp;&amp;</span> <span class="token function">createPortal</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ToastMessage</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">,</span> document<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">SearchFilterBar</span></span> <span class="token attr-name">filterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>article<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ListContainer</span></span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span>data<span class="token operator">?.</span>pages
          <span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span> <span class="token operator">=></span> page<span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token operator">:</span> ArticleProps<span class="token punctuation">,</span> index<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ArticleListItem</span></span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span></span> <span class="token attr-name">data</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>
          <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>loadingRef<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>isFetchingNextPage<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ListContainer</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>데이터를 불러오는 커스텀 훅(useGetArticles.ts)에서 <code class="language-text">useInfiniteQeury</code>를 사용하여 <code class="language-text">data</code>, <code class="language-text">isError</code>, <code class="language-text">isLoading</code>, <code class="language-text">fetchNextPage</code>, <code class="language-text">hasNextPage</code>, <code class="language-text">isFetchingNextPage</code>를 반환한다. 부모 컴포넌트(ArticleList.tsx)에서는 데이터 페칭이 실패한 경우(<code class="language-text">isError</code>)에는 에러 페이지를, 로딩(<code class="language-text">isLoading</code>)시에는 로딩 컴포넌트를 보여준다. 스크롤을 내릴 때 viewport에 진입했는지의 여부를 확인하기 위해 Intersection Observer API를 이용하여 커스텀 훅(useInfinityScroll.ts)을 작성했고 이를 컴포넌트 최하단에 관찰 요소로 적용하여 다음 페이지의 데이터를 가져오도록 했다.</p>
<h2 id="느낀-점" style="position:relative;"><a href="#%EB%8A%90%EB%82%80-%EC%A0%90" aria-label="느낀 점 permalink" class="custom-class before"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>느낀 점</h2>
<ul>
<li>여러 방법을 통해 구현해봤는데 <strong>화면의 관찰하고 조건이 성립되면 데이터를 불러오는 방식</strong>이 기본임을 알게 됐다.</li>
<li><code class="language-text">useInfiniteQuery</code>는 무한 스크롤을 위한 참조까지 가능하다고 생각했으나, 데이터를 불러오기 더 나은 방법일 뿐이다.</li>
<li>작성된 코드들을 보면서 좀 더 클린하게 작성할 순 없었는지 아쉬움이 남는다.</li>
<li>서비스를 운영하는 기업의 입장에서는 해당 기능이 체류시간의 증가라는 이득을 가져다주지만, 디자이너였던 나에게 무한 스크롤은 액션 자체에 중독시킨다는 디자인 윤리에 대한 문제가 있기도 하다. 언젠가 이런 다크 패턴을 없애는 인터랙션을 개발해보고 싶다.</li>
</ul></article><style data-emotion="css gobcxo">.css-gobcxo{width:644px;margin:0 auto;}</style><div class="css-gobcxo e19cb0pr0"></div></main><div class="css-1vs9i7r e1yku1bn1"><style data-emotion="css nmlyvz">.css-nmlyvz{padding:16px 0 0 40px;opacity:0.3;-webkit-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out;overflow-y:auto;position:-webkit-sticky;position:sticky;top:94px;max-height:calc(100vh - 54px - 40px);}.css-nmlyvz:hover{opacity:1;}.css-nmlyvz ul{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:8px;list-style-type:none;}.css-nmlyvz li{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:8px;}.css-nmlyvz p{padding:12px;border-radius:6px;color:#222;-webkit-text-decoration:none;text-decoration:none;line-height:1.4;-webkit-filter:grayscale(100%);filter:grayscale(100%);-webkit-transition:filter 0.2s ease-in-out;transition:filter 0.2s ease-in-out;}.css-nmlyvz p:hover{-webkit-filter:none;filter:none;background-color:rgba(0, 0, 0, 0.07);}.css-nmlyvz p a{padding:0;border-radius:0;background-color:transparent;-webkit-filter:none;filter:none;-webkit-transition:none;transition:none;}.css-nmlyvz p a:hover{background-color:transparent;}.css-nmlyvz a{padding:12px;border-radius:6px;color:#222;-webkit-text-decoration:none;text-decoration:none;line-height:1.4;-webkit-filter:grayscale(100%);filter:grayscale(100%);-webkit-transition:filter 0.2s ease-in-out;transition:filter 0.2s ease-in-out;}.css-nmlyvz a:hover{-webkit-filter:none;filter:none;background-color:rgba(0, 0, 0, 0.07);}.css-nmlyvz a:visited{color:#222;-webkit-text-decoration:none;text-decoration:none;}</style><div class="css-nmlyvz e1yku1bn0"><ul>
<li><a href="#%EB%AC%B4%ED%95%9C-%EC%8A%A4%ED%81%AC%EB%A1%A4-%EB%A8%BC%EC%A0%80%EB%B3%B4%EA%B8%B0">무한 스크롤 먼저보기</a></li>
<li><a href="#%EC%82%AC%EC%9A%A9%ED%95%9C-%EA%B8%B0%EC%88%A0">사용한 기술</a></li>
<li><a href="#1-useeffect">1. useEffect</a></li>
<li><a href="#2-intersection-observer-api">2. Intersection Observer API</a></li>
<li><a href="#3-useinfinitequery-react-query">3. useInfiniteQuery (React-Query)</a></li>
<li><a href="#%EB%8A%90%EB%82%80-%EC%A0%90">느낀 점</a></li>
</ul></div></div></section></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/infinite-scroll/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-81f7d0ae45ba02b7bbb4.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-440e429d9a62337254ad.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-f74ee2ea820974930722.js\"],\"component---src-templates-post-template-tsx\":[\"/component---src-templates-post-template-tsx-3c33960374d764cde8a1.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="962812ac1413ab288312";</script><script src="/webpack-runtime-b7b34215dac00c8cd07c.js" async></script><script src="/framework-6d0a148669501e76aa8f.js" async></script><script src="/app-81f7d0ae45ba02b7bbb4.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>