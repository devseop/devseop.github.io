<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.6.1"/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1.0"/><meta data-react-helmet="true" http-equiv="Content-Type" content="text/html;charset=UTF-8"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:title" content="Next.js 프로젝트 배포하기 (Docker, AWS S3)"/><meta data-react-helmet="true" property="og:url"/><meta data-react-helmet="true" property="og:site_name" content="Next.js 프로젝트 배포하기 (Docker, AWS S3)"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="Next.js 프로젝트 배포하기 (Docker, AWS S3)"/><meta data-react-helmet="true" name="twitter:site" content="@사용자이름"/><meta data-react-helmet="true" name="twitter:creator" content="@사용자이름"/><style data-href="/styles.9e907bc32054b7771552.css" data-identity="gatsby-global-css">code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#ccc;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}</style><link rel="canonical" href="https://devseop.github.io/deploy-with-aws/" data-baseprotocol="https:" data-basehost="devseop.github.io"/><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/><title data-react-helmet="true">Next.js 프로젝트 배포하기 (Docker, AWS S3)</title><link data-react-helmet="true" rel="shortcut icon" href="favicon.ico"/><link data-react-helmet="true" rel="icon" href="favicon.ico"/><link data-react-helmet="true" rel="icon" type="image/png" href="favicon.ico" sizes="16x16"/><style type="text/css">
    .custom-class.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .custom-class.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .custom-class svg,
    h2 .custom-class svg,
    h3 .custom-class svg,
    h4 .custom-class svg,
    h5 .custom-class svg,
    h6 .custom-class svg {
      visibility: hidden;
    }
    h1:hover .custom-class svg,
    h2:hover .custom-class svg,
    h3:hover .custom-class svg,
    h4:hover .custom-class svg,
    h5:hover .custom-class svg,
    h6:hover .custom-class svg,
    h1 .custom-class:focus svg,
    h2 .custom-class:focus svg,
    h3 .custom-class:focus svg,
    h4 .custom-class:focus svg,
    h5 .custom-class:focus svg,
    h6 .custom-class:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 100)
          }), 0)
        }
      }
    })
  </script><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css-global 12mkisr">@import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.6/dist/web/static/pretendard-dynamic-subset.css');*{padding:0;margin:0;box-sizing:border-box;font-family:'Pretendard',san-serif;}body{background:#fff;}a,a:hover{-webkit-text-decoration:none;text-decoration:none;cursor:pointer;}</style><style data-emotion="css 15b5qda">.css-15b5qda{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;padding:12px 40px;background-color:rgba(255, 255, 255, 0.6);box-shadow:0px 1px 0px 0px rgba(34, 34, 34, 0.2);-webkit-backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);position:-webkit-sticky;position:sticky;top:0;z-index:1;}</style><nav class="css-15b5qda ehcuuqj5"><style data-emotion="css 19f4qz1">.css-19f4qz1{line-height:1;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;}.css-19f4qz1 h1{font-size:24px;font-weight:500;}.css-19f4qz1 a{-webkit-text-decoration:none;text-decoration:none;}.css-19f4qz1 a:visited{color:#222;}</style><div class="css-19f4qz1 ehcuuqj4"><a href="/"><h1>이윤섭</h1></a></div><style data-emotion="css udmynv">.css-udmynv{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:16px;}</style><div class="css-udmynv ehcuuqj3"><style data-emotion="css 1c46kml">.css-1c46kml{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:4px;padding:0 16px;margin-top:5px;color:#222;-webkit-text-decoration:none;text-decoration:none;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;cursor:pointer;}.css-1c46kml:hover{color:#3680ff;}</style><a href="https://drive.google.com/file/d/1xOZNJKoUjCpREhfGxfwwZv3Vgr1O_OhV/view?usp=sharing" target="_blank" class="css-1c46kml ehcuuqj2"><style data-emotion="css 14is9qy">.css-14is9qy{font-size:20px;}</style><div class="css-14is9qy ehcuuqj1"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M7.38938 16.5386C5.33894 15.0901 4 12.7014 4 10C4 5.58172 7.58172 2 12 2C16.4183 2 20 5.58172 20 10C20 12.7014 18.6611 15.0901 16.6106 16.5386L18.6936 21.2996C18.8043 21.5526 18.6889 21.8474 18.4359 21.9581C18.3727 21.9857 18.3045 22 18.2355 22H5.76451C5.48837 22 5.26451 21.7761 5.26451 21.5C5.26451 21.431 5.27878 21.3628 5.30643 21.2996L7.38938 16.5386ZM8.11851 10.9704C8.55217 12.7106 10.1255 14 12 14C13.8745 14 15.4478 12.7106 15.8815 10.9704L13.9407 10.4852C13.7239 11.3553 12.9372 12 12 12C11.0628 12 10.2761 11.3553 10.0593 10.4852L8.11851 10.9704Z"></path></svg></div><style data-emotion="css mqo9y5">.css-mqo9y5{line-height:1;margin-top:3px;}</style><span class="css-mqo9y5 ehcuuqj0">이력서</span></a><a href="https://github.com/devseop/" target="_blank" class="css-1c46kml ehcuuqj2"><div class="css-14is9qy ehcuuqj1"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M12.001 2C6.47598 2 2.00098 6.475 2.00098 12C2.00098 16.425 4.86348 20.1625 8.83848 21.4875C9.33848 21.575 9.52598 21.275 9.52598 21.0125C9.52598 20.775 9.51348 19.9875 9.51348 19.15C7.00098 19.6125 6.35098 18.5375 6.15098 17.975C6.03848 17.6875 5.55098 16.8 5.12598 16.5625C4.77598 16.375 4.27598 15.9125 5.11348 15.9C5.90098 15.8875 6.46348 16.625 6.65098 16.925C7.55098 18.4375 8.98848 18.0125 9.56348 17.75C9.65098 17.1 9.91348 16.6625 10.201 16.4125C7.97598 16.1625 5.65098 15.3 5.65098 11.475C5.65098 10.3875 6.03848 9.4875 6.67598 8.7875C6.57598 8.5375 6.22598 7.5125 6.77598 6.1375C6.77598 6.1375 7.61348 5.875 9.52598 7.1625C10.326 6.9375 11.176 6.825 12.026 6.825C12.876 6.825 13.726 6.9375 14.526 7.1625C16.4385 5.8625 17.276 6.1375 17.276 6.1375C17.826 7.5125 17.476 8.5375 17.376 8.7875C18.0135 9.4875 18.401 10.375 18.401 11.475C18.401 15.3125 16.0635 16.1625 13.8385 16.4125C14.201 16.725 14.5135 17.325 14.5135 18.2625C14.5135 19.6 14.501 20.675 14.501 21.0125C14.501 21.275 14.6885 21.5875 15.1885 21.4875C19.259 20.1133 21.9999 16.2963 22.001 12C22.001 6.475 17.526 2 12.001 2Z"></path></svg></div><span class="css-mqo9y5 ehcuuqj0">깃허브</span></a></div></nav><style data-emotion="css 1980g9g">.css-1980g9g{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin:40px auto;max-width:1440px;}</style><section class="css-1980g9g ekkml1s1"><style data-emotion="css 1vs9i7r">.css-1vs9i7r{width:360px;}</style><aside class="css-1vs9i7r e199j04p4"><style data-emotion="css 1o7upgt">.css-1o7upgt{padding:16px 40px 0 0;opacity:0.3;-webkit-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out;overflow-y:auto;position:-webkit-sticky;position:sticky;top:94px;max-height:calc(100vh - 54px - 40px);}.css-1o7upgt:hover{opacity:1;}</style><nav class="css-1o7upgt e199j04p3"><style data-emotion="css oyx6p9">.css-oyx6p9{margin:0 0 16px 12px;color:#222;font-size:24px;font-weight:500;line-height:1;letter-spacing:-0.72px;}</style><h1 class="css-oyx6p9 e199j04p2">작성글</h1><style data-emotion="css 9xgbk0">.css-9xgbk0{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:8px;list-style-type:none;}</style><ul class="css-9xgbk0 e199j04p1"><style data-emotion="css 1wgpsw9">.css-1wgpsw9{padding:12px;border-radius:6px;-webkit-filter:grayscale(100%);filter:grayscale(100%);-webkit-transition:filter 0.2s ease-in-out;transition:filter 0.2s ease-in-out;cursor:pointer;}.css-1wgpsw9:hover{-webkit-filter:none;filter:none;background-color:rgba(0, 0, 0, 0.07);}.css-1wgpsw9 a{color:#222;-webkit-text-decoration:none;text-decoration:none;line-height:1.4;}.css-1wgpsw9 a:visited{color:#222;-webkit-text-decoration:none;text-decoration:none;}</style><li class="css-1wgpsw9 e199j04p0"><a href="/what-is-useref/">옆에서 구경만 하는 조용한 친구: useRef</a></li><li class="css-1wgpsw9 e199j04p0"><a href="/js-debouncing-n-throttling/">자바스크립에서 이벤트 제어하기: Debouncing &amp; Throttling</a></li><li class="css-1wgpsw9 e199j04p0"><a href="/blog-publish-review/">Gatsby로 블로그 만들기</a></li><li class="css-1wgpsw9 e199j04p0"><a href="/merge-two-sorted-list/">단일 연결 리스트 합치기</a></li><li class="css-1wgpsw9 e199j04p0"><a href="/teo-sprint-11th/">테오의 스프린트 11기 후기</a></li><li class="css-1wgpsw9 e199j04p0"><a href="/nth-type-difference/">nth-child와 nth-of-type의 차이</a></li><li class="css-1wgpsw9 e199j04p0"><a href="/deploy-with-aws/">Next.js 프로젝트 배포하기 (Docker, AWS S3)</a></li><li class="css-1wgpsw9 e199j04p0"><a href="/2nd-project-review/">위코드 2차 프로젝트 후기</a></li><li class="css-1wgpsw9 e199j04p0"><a href="/1st-project-review/">위코드 1차 프로젝트 후기</a></li></ul></nav></aside><style data-emotion="css 15x83x4">.css-15x83x4{max-width:644px;}</style><main class="css-15x83x4 ekkml1s0"><style data-emotion="css gz1wck">.css-gz1wck{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-width:644px;max-width:644px;margin:0 auto;}</style><header class="css-gz1wck exws4ym3"><style data-emotion="css 19obpe4">.css-19obpe4{display:-webkit-box;overflow:hidden;overflow-wrap:break-word;text-overflow:ellipsis;white-space:normal;-webkit-line-clamp:2;-webkit-box-orient:vertical;font-size:36px;font-weight:700;line-height:1.2;margin-bottom:12px;color:#222;}</style><h2 class="css-19obpe4 exws4ym2">Next.js 프로젝트 배포하기 (Docker, AWS S3)</h2><style data-emotion="css d2fic6">.css-d2fic6{font-size:14px;color:#222;}</style><p class="css-d2fic6 exws4ym1">2022.07.06.</p></header><style data-emotion="css 14g9osq">.css-14g9osq{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:644px;margin:0 auto;padding:64px 0;word-break:break-all;color:#222;line-height:1.5;font-size:17px;font-weight:400;}.css-14g9osq p{padding:0;}.css-14g9osq h1,.css-14g9osq h2,.css-14g9osq h3{font-weight:700;margin-bottom:16px;}.css-14g9osq *+h1,.css-14g9osq *+h2,.css-14g9osq *+h3{margin-top:40px;}.css-14g9osq hr+h1,.css-14g9osq hr+h2,.css-14g9osq hr+h3{margin-top:0;}.css-14g9osq h1{font-size:32px;}.css-14g9osq h2{font-size:24px;}.css-14g9osq h3{font-size:20px;}.css-14g9osq blockquote{margin:32px 0;padding:20px 32px 20px;border-left:4px solid #4263eb;font-weight:400;background:rgba(34, 34, 34, 0.05);line-height:1.5;}.css-14g9osq ol,.css-14g9osq ul{margin-left:20px;}.css-14g9osq hr{border:0.5px solid rgba(34, 34, 34, 0.5);margin:64px 0;}.css-14g9osq a{color:#4263eb;-webkit-text-decoration:underline;text-decoration:underline;}.css-14g9osq table{margin:24px 0;background-color:rgba(34, 34, 34, 0.05);border:0.5px solid rgba(34, 34, 34, 0.3);font-size:14px;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;min-width:40%;max-width:100%;border-collapse:collapse;box-sizing:inherit;}.css-14g9osq th{padding:8px;border-bottom:3px solid rgba(34, 34, 34, 0.3);}.css-14g9osq td{padding:8px;}.css-14g9osq table td+td,.css-14g9osq table th+th{border-left:0.5px solid rgba(34, 34, 34, 0.3);}.css-14g9osq pre[class*='language-']{margin:16px 0;padding:16px 20px;font-size:14px;border-radius:10px;}.css-14g9osq pre[class*='language-']::-webkit-scrollbar-thumb{background:rgba(255, 255, 255, 0.5);border-radius:3px;}.css-14g9osq code[class*='language-'],.css-14g9osq pre[class*='language-']{tab-size:2;}.css-14g9osq pre>code{font-family:'JetBrains Mono';}.css-14g9osq pre>code .token.function{color:#b392f0;}.css-14g9osq pre>code .token.keyword,.css-14g9osq pre>code .token.operator{color:#f97583;}.css-14g9osq pre>code .token.string,.css-14g9osq pre>code .token.constant,.css-14g9osq pre>code .token.boolean,.css-14g9osq pre>code .token.number{color:#9ecbff;}.css-14g9osq pre>code .token.parameter{color:#ffab70;}.css-14g9osq pre>code .token.literal-property.property{color:#fff;}@media (max-width: 768px){.css-14g9osq{width:644px;padding:80px 20px;line-height:1.6;font-size:14px;}.css-14g9osq h1{font-size:23px;}.css-14g9osq h2{font-size:20px;}.css-14g9osq h3{font-size:17px;}.css-14g9osq h4{font-size:17px;font-weight:500;}.css-14g9osq img{width:100%;}.css-14g9osq hr{margin:50px 0;}}</style><article class="css-14g9osq exws4ym0"><h2 id="Nextjs-Is" style="position:relative;"><a href="#Nextjs-Is" aria-label="Nextjs Is permalink" class="custom-class before"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Next.js Is</h2>
<blockquote>
<p>Next.js is a flexible React framework that gives you building blocks to create fast web applications.
(Next.js 공식문서 발췌)</p>
</blockquote>
<p>Next.js는 React 라이브러리의 프레임워크이며, 가장 큰 특징으로는 SEO 향상과 SSR(Server-Side Rendering)을 가능케 한다는 것이다. 리액트는 기본적으로 CSR(Client-Side Rendering)을 지원하는데 Next.js를 이용하면 pre-render를 통해 미리 데이터가 렌더링된 페이지를 가져올 수 있게 할 뿐 아니라 검색엔진에도 노출이 잘 되기 때문에 제품의 SEO 향상에도 큰 도움이 된다.</p>
<h2 id="Docker-Is" style="position:relative;"><a href="#Docker-Is" aria-label="Docker Is permalink" class="custom-class before"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Docker Is</h2>
<blockquote>
<p>Docker는 애플리케이션을 신속하게 구축, 테스트 및 배포할 수 있는 소프트웨어 플랫폼입니다. Docker는 소프트웨어를 컨테이너라는 표준화된 유닛으로 패키징하며, 이 컨테이너에는 라이브러리, 시스템 도구, 코드, 런타임 등 소프트웨어를 실행하는 데 필요한 모든 것이 포함되어 있습니다.
(AWS Docker 설명에서 발췌)</p>
</blockquote>
<p>Docker를 검색하면 가장 처음 보는 단어는 이미지, 컨테이너, 배포이다. 이미지는 컨테이너 실행에 필요한 파일과 설정값들을 포함한 것이며, 컨테이너는 격리된 공간에서 프로세스가 동작하는 기술이다. 처음엔 나도 잘 이해가 되지 않았다. 코드 블록이 이미지라니? 컨테이너는 또 뭐야? 여러번 읽고 나서도 이해가 잘 가지 않아 Adobe Illustrator와 비교해서 이해하기로 했다.</p>
<table>
<thead>
<tr>
<th>Docker</th>
<th>Adobe Illustrator</th>
</tr>
</thead>
<tbody>
<tr>
<td>이미지</td>
<td>아트보드</td>
</tr>
<tr>
<td>컨테이너</td>
<td>파일</td>
</tr>
</tbody>
</table>
<p>일러스트레이터(서버) 안에서 여러개의 작업 파일(컨테이너)를 작동할 수 있고, 각 파일에는 여러개의 아트보드(이미지)가 포함된다고 이해하니 도커가 어떤 방식으로 작동되는지 전보다 쉽게 이해할 수 있었다.</p>
<h2 id="Docker--EC2로-배포하기" style="position:relative;"><a href="#Docker--EC2%EB%A1%9C-%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0" aria-label="Docker  EC2로 배포하기 permalink" class="custom-class before"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Docker + EC2로 배포하기</h2>
<p>처음 백엔드 개발자분과 얘기했을 때는 서로의 환경에서 배포가 어떻게 진행되는지 전혀 알 수 없었기 때문에 시행착오가 많았다.(이전 기수분들의 인수인계 때 vercel을 이용해서 배포하면 쉽다고 했는데 그걸 이해했을 땐 Doker로 이미 배포가 완료된 상태였다.)
</br></p>
</br>
해당 기업에서는 테스트 서버 배포를 원하였으므로 git clone을 받아 EC2로 배포하기로 협의헀다. 배포방법은 다른 포스트에도 많아 자세히 다루지 않겠지만 내가 경험한 배포 순서를 간단히 정리하자면 아래와 같다.
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">1. dockerfiledp env-cmd 패키지를 다운로드하는 명령어를 추가
2. package.json의 build에 env-cmd -f ~/.env.dev 명렁어를 추가
3. root에 .env.dev를 생성</code></pre></div>
<p>이렇게 프론트 테스트 서버가 성공적으로 끝난 줄 알았지만 배포 후 백엔드 개발자님께서 배포 방식이 잘못됨을 언급, S3로 재배포해야 한다고 하셨다. (사실 경험이 없어 어떤 배포 방법이 더 좋은지 알지 못 했고, 이 부분은 전적으로 백엔드 개발자님의 의견을 따르기로 했다.)</p>
<h2 id="S3로-재배포하기" style="position:relative;"><a href="#S3%EB%A1%9C-%EC%9E%AC%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0" aria-label="S3로 재배포하기 permalink" class="custom-class before"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>S3로 재배포하기</h2>
<p>S3로의 재배포는 백엔드 개발자님이 미리 배포를 위한 준비를 해주신 상태였고, 나는 준비해둔 bucket에 프로젝트를 업로드만 하면 되는 상태였다. 배포는 프로젝트를 build하면 프로젝트 폴더에 out이라는 폴더가 생기는데 이 때 out 폴더 안에 있는 모든 폴더 및 파일을 업로드해주면 끝이다. Docker로 했을 때보다 더욱 심플했다. 다만 build시 sessionStorage 혹은 localStorage is no defined라는 경고 문구가 뜨면서 build가 되지 않은 문제를 겪을 것이다.
</br></p>
</br>
Next.js는 CSR을 실행하기 전에 SSR을 실행하는데, Next.js에서 제공하는 SSR에서는 window나 document와 같은 전역 객체 사용이 불가능하다. 따라서 페이지가 client에 로드되고 전역객체가 정의되기 전까지는 sessionStorage 혹은 localStorage에 접근할 수 없다!
</br>
</br>
이럴 땐 페이지가 client에 마운트 될 때까지 기다린 후 스토리지에 접근해야 하는데 이를 해결할 수 있는 방법은 아래와 같다.
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> window <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Perform localStorage action</span>
  <span class="token keyword">const</span> item <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>스토리지를 이용한 코드블럭에 위와 같이 수정 후 빌드하니 이상없이 빌드가 완료되고, 성공적으로 S3에 업로드 할 수 있었다.</p>
<h2 id="회고" style="position:relative;"><a href="#%ED%9A%8C%EA%B3%A0" aria-label="회고 permalink" class="custom-class before"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>회고</h2>
<p>배포를 맡기로 했을 땐 사용하는 플랫폼이나 언어의 특징, 그리고 수많은 오류들이 걱정이 되었다. 그러나 백엔드 개발자님과 함께 Docker로 먼저 배포를 해보며 오류를 맞이하는 것에 대한 두려움이 많이 줄어들었고, 이 또한 나를 성장시킬 수 있는 양분이 된다고 생각하니 오류를 해결하는 것이 진짜 개발자 같이 느껴져 재밌어지기 시작했다. 하지만 예상했던 것보다 더 많은 오류와 시행착오로 시간이 많이 소요되었다. ‘프론트엔드니까 배포는 중요하지 않겠지?‘라는 마인드로 임했던 과거의 나를 반성하는 계기가 되었다.</p></article><style data-emotion="css gobcxo">.css-gobcxo{width:644px;margin:0 auto;}</style><div class="css-gobcxo e19cb0pr0"></div></main><div class="css-1vs9i7r e1yku1bn1"><style data-emotion="css nmlyvz">.css-nmlyvz{padding:16px 0 0 40px;opacity:0.3;-webkit-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out;overflow-y:auto;position:-webkit-sticky;position:sticky;top:94px;max-height:calc(100vh - 54px - 40px);}.css-nmlyvz:hover{opacity:1;}.css-nmlyvz ul{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:8px;list-style-type:none;}.css-nmlyvz li{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:8px;}.css-nmlyvz p{padding:12px;border-radius:6px;color:#222;-webkit-text-decoration:none;text-decoration:none;line-height:1.4;-webkit-filter:grayscale(100%);filter:grayscale(100%);-webkit-transition:filter 0.2s ease-in-out;transition:filter 0.2s ease-in-out;}.css-nmlyvz p:hover{-webkit-filter:none;filter:none;background-color:rgba(0, 0, 0, 0.07);}.css-nmlyvz p a{padding:0;border-radius:0;background-color:transparent;-webkit-filter:none;filter:none;-webkit-transition:none;transition:none;}.css-nmlyvz p a:hover{background-color:transparent;}.css-nmlyvz a{padding:12px;border-radius:6px;color:#222;-webkit-text-decoration:none;text-decoration:none;line-height:1.4;-webkit-filter:grayscale(100%);filter:grayscale(100%);-webkit-transition:filter 0.2s ease-in-out;transition:filter 0.2s ease-in-out;}.css-nmlyvz a:hover{-webkit-filter:none;filter:none;background-color:rgba(0, 0, 0, 0.07);}.css-nmlyvz a:visited{color:#222;-webkit-text-decoration:none;text-decoration:none;}</style><div class="css-nmlyvz e1yku1bn0"><ul>
<li><a href="#nextjs-is">Next.js Is</a></li>
<li><a href="#docker-is">Docker Is</a></li>
<li><a href="#docker--ec2%EB%A1%9C-%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0">Docker + EC2로 배포하기</a></li>
<li><a href="#s3%EB%A1%9C-%EC%9E%AC%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0">S3로 재배포하기</a></li>
<li><a href="#%ED%9A%8C%EA%B3%A0">회고</a></li>
</ul></div></div></section></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/deploy-with-aws/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-81f7d0ae45ba02b7bbb4.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-440e429d9a62337254ad.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-ec0f816a3f45b90da5ec.js\"],\"component---src-templates-post-template-tsx\":[\"/component---src-templates-post-template-tsx-44e5f8686ee2f3993d33.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="8b7befa8d376a1d035f9";</script><script src="/webpack-runtime-600e555076f27a515647.js" async></script><script src="/framework-6d0a148669501e76aa8f.js" async></script><script src="/app-81f7d0ae45ba02b7bbb4.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>